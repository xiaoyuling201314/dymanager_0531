require([ "../config.min", "../base.min" ], function() {

	$(function() {
		//验证设计文档文件，验证通过并提交
		$("#btnSave").on("click", function() {
			var fileName = $("[name=fileName]").val();
			var version = $("[name=version]").val();
			var subfix = test($("input[name=myFile]").val());
			if(validate()){
			$.ajax({
				url : "documentService/checkFileVersion.do",
				type : "POST",
				dataType : "json",
				data : {
					"fileName" : fileName,
					"version" : version,
					"subfix" : subfix
				},
				success : function(data) {
					if (data.isExit == 'true') {// 存在
						alert("该设计文档" + version + "版本已存在,请确认说明书和版本号是否有误");
					} else {
						$("[name=documentForm]").submit();
					}
				},
				error : function() {
					alert("操作失败");
				}
			});
			}
		});
	    $("#returnbtn").on("click",function(){
		     if($("[name=fileName]").val()!='' || $("[name=version]").val()!='' || $("[name=reviser]").val()!=''){
		        if(confirm("确定放弃编辑返回吗？")){
		           location.href=basePath+"documentService/documentList.do";
		        }
		       }else{
		          location.href=basePath+"documentService/documentList.do";
		       }
	     });
	});

});