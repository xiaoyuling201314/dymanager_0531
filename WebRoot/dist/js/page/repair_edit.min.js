require(["../config.min","../base.min"],
		function(){require(["common/upload.min"],//故障图片上传
				function(){$("#picUpload").uploader({server:basePath+"repairService/uploadPicture.do",fileNumLimit:countFaultPicture}).on("accept.upload",function(t,e){var a=$('input[name="faultPicture"]').val();a=""==a?e.fileName:a+","+e.fileName,$('input[name="faultPicture"]').val(a),console.log($('input[name="faultPicture"]').val())})}),
				$(function(){$("#statusSelect").on("change",function(){"1"==$(this).val()?$("#statusRelated").show():$("#statusRelated").hide()}),
					$("#fileicon-pdf").attr("style","display:none"),$("#fileicon-word").attr("style","display:none"),
					$(".right").attr("style","display:none"),$(".error").attr("style","display:none"),$(".deletFile").attr("style","display:none"),
					$("[name=repairOrderNumber]").on("blur",function(){var t=$(this).val();""!=t?$.ajax({url:"repairService/checkRepairOrderNumber.do",type:"POST",data:{"repairOrderNumber":t},dataType:"json",success:function(e){"true"==e.isExit?($(".error").attr("style","display:block"),$(".right").attr("style","display:none"),$(".sapNoMessage").html("该单号已被占用")):($(".right").attr("style","display:block"),$(".error").attr("style","display:none"),$(".sapNoMessage").html(""),sapNoValue=t)},
						error:function(){alert("操作失败"),$(".right").attr("style","display:none"),$(".error").attr("style","display:none")}}):($(".error").attr("style","display:none"),$(".right").attr("style","display:none"),$(".sapNoMessage").html(""))}),
						//机身码检验start
						$("[name=instrumentFuselage]").on("blur",function(){
							var t=$(this).val();""!=t?$.ajax({url:"repairService/checkShipByFuselage.do",
								type:"POST",
								data:{"fuselage":t},
								dataType:"json",
								success:function(e)
								{"true"!=e.isExit?($(".error2").attr("style","display:block"),$(".right2").attr("style","display:none"),
										alert("机身码不存在，请重新输入")):($(".right2").attr("style","display:block"),$(".error2").attr("style","display:none"),$("[name=sapNo]").val(e.shipMents.sapNo.sapNo),$("[name=productName]").val(e.shipMents.sapNo.productName),$("[name=shipmentNo]").val(e.shipMents.id),$(".sapNoMessage2").html(""),sapNoValue=t)},
							error:function(){
								alert("操作失败"),$(".right2").attr("style","display:none"),
								$(".error2").attr("style","display:none")}}):($(".error2").attr("style","display:none"),
										$(".right2").attr("style","display:none"),$(".sapNoMessage2").html(""))}),
						//机身码校验end
						//设置计划完成日期，默认为接收日期+7天start
						$("[name=receivedDate]").on("blur",function(){
											var t=$(this).val();
											var datetime=new Date();
											var nowTime=datetime.getFullYear()+"-"+(datetime.getMonth()+1)+"-"+datetime.getDate();
											if(""!=t){
												t.setDate(t.getDate()+7);
												nowTime=t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate();
											}else{
												$("[name=receivedDate]").val(nowTime);
												datetime.setDate(datetime.getDate()+7);
												nowTime=datetime.getFullYear()+"-"+(datetime.getMonth()+1)+"-"+datetime.getDate();
											}
											$("[name=planCompleteDate]").val(nowTime);
						}),
						//设置计划完成日期，默认为接收日期+7天end			
						$("#returnbtn").on("click",function(){""!=$("[name=sapNo]").val()||""!=$("[name=productName]").val()?confirm("确定放弃编辑返回吗？")&&(location.href=basePath+"repairService/repairList.do"):location.href=basePath+"repairService/repairList.do"})
					  //处理方法图片
						require(["common/upload.min"],
								function(){$("#picUpload2").uploader({server:basePath+"repairService/uploadPicture.do",fileNumLimit:countDealPicture}).on("accept.upload",function(t,e){var a=$('input[name="processingPicture"]').val();a=""==a?e.fileName:a+","+e.fileName,$('input[name="processingPicture"]').val(a),console.log($('input[name="processingPicture"]').val())})
						})
				})
						
});