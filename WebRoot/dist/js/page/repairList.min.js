require(["../config.min","../base.min"],function(){require(["common/pagination.min"],function(){$("#pagination").pagination({pageCount:pageCount,current:curPage,callback:function(n){var t=n.getCurrent();$("#listForm input[name='curPage']").val(t),$("#listForm").submit()}})}),
	require(["common/lightbox.min"],function(n){n.run(".gallery")}),
	require(["common/alert.min"],
	function(n){$(".delete").on("click",
	function(){
		var repairOrderNumber = $(this).attr("data-id");
		n.confirm("您确定要删除吗？", function() {
			$.ajax({
				url : "repairService/delRepair.do",
				type : "POST",
				data : {
					"repairOrderNumber" : repairOrderNumber
				},
				dataType:"json",
				success : function(data) {
					if(data.result=='success'){
			               location.reload();
					}else{
						alert("操作失败");
					}
				},
				error : function() {
					alert("操作失败");
				}
			})
		})
	})
	}),require(["common/modal.min"]),require(["common/lightbox.min"],
			function(n){n.run(".gallery")}),
	$(function(){
		 //查看出货详情
		  $(".detail").on("click",function(){
			  $(".pics").find("li").remove();
			  $(".picsDeal").find("li").remove();
		   		var repairOrderNumber=$(this).attr("data-id");
		   		$.ajax({url:"repairService/queryRepairDetail.do",
				type:"POST",
				data:{"repairOrderNumber":repairOrderNumber},
				dataType:"json",
				success:function(data){
		         //alert(data.shipMents.sapNo.sapNo);
		         $("[name=detail_Title]").html(data.repairRecords.repairOrderNumber);
		         $("[name=repairOrderNumber]").html(data.repairRecords.repairOrderNumber);
		         $("[name=instrumentFuselage]").html(data.repairRecords.instrumentFuselage);
		         $("[name=sapNo]").html(data.repairRecords.shipmentNo.sapNo.sapNo);
		         $("[name=productName]").html(data.repairRecords.shipmentNo.sapNo.productName);
		         $("[name=receivedDate]").html(data.repairRecords.receivedDate);
		         $("[name=planCompleteDate]").html(data.repairRecords.planCompleteDate);
		         $("[name=repairMan]").html(data.repairRecords.repairMan);
		         $("[name=actualCompleteDate]").html(data.repairRecords.actualCompleteDate);
		          
		          $("[name=faultDescription]").html(data.repairRecords.faultDescription);
			      $("[name=processingMethod]").html(data.repairRecords.processingMethod);
			      $("[name=comments]").html(data.repairRecords.comments);
			      //显示图片  <img width="94px" height="90px" src="${picturePath}${picture}" title="图片" alt="图片" data-id="${picture}">
			     if(data.repairRecords.faultPicture!=null && data.repairRecords.faultPicture!=""){
			      var faultPictureList=data.repairRecords.faultPicture.split(",");
			     // $(".pics").find("li").remove();
			      if(faultPictureList.length>0){
			    	  $("#viewDetailModal").attr("style","height: 600px;");
				      for ( var i = 0; i < faultPictureList.length; i++) {
				    	  $(".pics").append(" <li class='listPic' style='width: 100px;height: 100px;float: left;margin-left:2px;margin-right:2px;'  ><img width='94px' height='90px' src='"+data.picturePath+faultPictureList[i]+"' title='图片' alt='图片' data-id='"+faultPictureList[i]+"'> </li>");
				    	  //$("#pics").append(" <a style='width: 24.36%;margin: 1px 5px;' href='"+data.picturePath+faultPictureList[i]+"'><img width='94px' height='88px' src='"+data.picturePath+faultPictureList[i]+"' alt='图片' title='图片'></a>");
				      
				      }
			      }
			     }else{
			    	 $(".pics").find("li").remove();
			    	// $(".picsDeal").append("<li>暂无故障图片</li>");
			     }
			     // $(".picsDeal").find("li").remove();
			      if(data.repairRecords.processingPicture!=null && data.repairRecords.processingPicture!=""){
			    	  var processingPictureList=data.repairRecords.processingPicture.split(",");
				      for ( var i = 0; i < processingPictureList.length; i++) {
				    	  $(".picsDeal").append(" <li class='listPic' style='width: 100px;height: 100px;float: left;margin-left:2px;margin-right:2px;'  ><img width='94px' height='90px' src='"+data.picturePath+processingPictureList[i]+"' title='图片' alt='图片' data-id='"+processingPictureList[i]+"'> </li>");
				    	  //("#picsDeal").append(" <a style='width: 24.36%;margin: 1px 5px;' href='"+data.picturePath+processingPictureList[i]+"'><img width='94px' height='88px' src='"+data.picturePath+processingPictureList[i]+"' alt='图片' title='图片'></a>");
				      }
			      }else{
			    	  //$(".picsDeal").find("li").remove();
			    	  $(".picsDeal").append("<li>暂无处理图片</li>");
			      }
			      
				},
				error:function(){
					alert("操作失败");
				}
				})
		  });
	});

});
